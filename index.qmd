---
title: "Causal Inference in R"
author:  "Malcolm Barrett, Lucy D'Agostino McGowan, Travis Gerke"
date: "`r Sys.Date()`"
documentclass: krantz
biblio-style: apalike
bibliography: citations.bib
link-citations: yes
colorlinks: yes
lot: yes
lof: yes
site: bookdown::bookdown_site
description: > 
  This book covers causal inference techniques to help statisticians, epidemiologists, economists, and data scientists implement best practices using R.
github-repo: malcolmbarrett/causal-inference-in-r
graphics: yes
#cover-image: images/cover.jpg
# Render pdf with:
# bookdown::render_book(output_format = "bookdown::pdf_book")
---

```{r}
#| label: setup
#| include: false
knitr::opts_chunk$set(
  echo = TRUE, 
  dev = "ragg_png",
  dpi = 740, 
  out.width = "80%",
  fig.width = 6,
  fig.asp = 0.618,
  fig.retina =3,
  fig.align = "center",
  fig.show = "hold"
)

options(
  tidyverse.quiet = TRUE, 
  tipr.verbose = FALSE,
  htmltools.dir.version = FALSE, 
  width = 55, 
  digits = 4,
  ggplot2.discrete.colour = ggokabeito::palette_okabe_ito(),
  ggplot2.discrete.fill = ggokabeito::palette_okabe_ito(),
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)

library(ggplot2)

theme_set(
  theme_minimal(base_size = 12, base_family = "Open Sans") %+replace% 
    theme(
      panel.grid.minor = element_blank()
    )
)

theme_dag <- function() {
  ggdag::theme_dag(base_family = "Open Sans")
}

geom_dag_label_repel <- function(...) {
  ggdag::geom_dag_label_repel(
      aes(x, y, label = label),
      box.padding = 3.5, 
      inherit.aes = FALSE,
      max.overlaps = Inf, 
      family = "Open Sans",
      seed = 10,
      label.size = NA, 
      label.padding = 0.1,
      size = 4,
      ...
    ) 
}

est_ci <- function(.df, rsample = FALSE) {
  if (!is.data.frame(.df) && is.numeric(.df)) {
    return(
      glue::glue("{round(.df[[1]], digits = 1)} (95% CI {round(.df[[2]], digits = 1)}, {round(.df[[3]], digits = 1)})")
      )
  }
  
  if (rsample) {
    glue::glue("{round(.df$.estimate, digits = 1)} (95% CI {round(.df$.lower, digits = 1)}, {round(.df$.upper, digits = 1)})")
  } else {
    glue::glue("{.df$estimate} (95% CI {.df$conf.low}, {.df$conf.high})")
  }
}
```

```{r}
#| child: frontmatter/preface.Rmd
```

```{r}
#| child: chapters/chapter-01.Rmd
```

```{r}
#| child: chapters/chapter-02.Rmd
```

```{r}
#| child: chapters/chapter-03.Rmd
```

```{r}
#| child: chapters/chapter-04.Rmd
```

```{r}
#| child: chapters/chapter-08.Rmd
```
